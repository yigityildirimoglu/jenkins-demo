# Jenkins CI aşamaları için uv, güncel pip ve gerekli araçları içeren özel agent imajı
FROM python:3.11-slim

# 1. Sistem araçlarını (bc, git) kur
RUN apt-get update && \
    apt-get install -y --no-install-recommends bc git && \
    rm -rf /var/lib/apt/lists/*

# 2. uv'yi pip ile kur
RUN pip install --no-cache-dir uv

# 3. pip, setuptools ve wheel'i uv kullanarak güncelle (pip-audit uyumluluğu için)
RUN uv pip install --system --upgrade pip setuptools wheel

# 4. Python test/lint/audit araçlarını uv ile kur
RUN uv pip install --no-cache --system flake8 pytest pytest-cov pip-audit

# 5. Varsayılan çalışma dizini
WORKDIR /app

# 6. Test için varsayılan komut
CMD ["uv", "--version"]